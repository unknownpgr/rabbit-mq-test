# RabbitMQ Test

이 프로젝트는 머신러닝 추론 서버와 같이 시간이 오래 걸리는 요청을 처리하는 서버를 위한 예제 아키텍쳐 프로젝트이다. 본 프로젝트는 `Node.js` 기반의 `api-server`와 `Python` 기반의 `inference-server` 서버 및 `RabbitMQ` 메시지 큐로 이루어진다. `api-server`는 `express`를 사용하여 간단한 api 서버를 구현하며

1. `api-server`는 유저로부터 요청을 받아 메시지 큐를 통해 `inference-server`로 요청 및 `응답 큐` 정보를 전송한다.
2. `inference-server`는 받은 요청을 처리한 후 받은 `응답 큐`로 다시 응답을 전송한다. 실제로는 머신러닝 추론을 진행하겠지만, 지금은 예시로써 두 수의 합을 구하는 연산을 진행하고 `time.sleep(10)` 을 실행하여 10초간 대기한다.
3. `api-server`는 `응답 큐`를 대기하다가 응답이 돌아오면 유저에게 다시 응답을 반환한다.

## 실행 방법

- `compose.sh` 를 실행한 후 `localhost:8080/?a=3&b=4`으로 접속한다. 그러면 10초 후 a+b가 반환된다.
- 같은 요청을 여러 탭에서 보냄으로써 여러 요청이 들어올 경우 어떻게 동작하는지를 테스트해볼 수 있다. 오류가 없는 경우 먼저 들어온 요청이 완전히 처리된 후 그 다음 요청이 처리된다.

> `RabbitMQ` 가 초기화되는 데에 수 초정도 시간이 걸리므로 유의한다.
